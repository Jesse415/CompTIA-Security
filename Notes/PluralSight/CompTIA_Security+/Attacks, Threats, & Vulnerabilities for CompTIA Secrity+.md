# Attacks, Threats, & Vulnerabilities for CompTIA Security+

### Comparing Different types of social engineering techniques
* A social engineer is someone who is a master of asking seemingly non-invasive questions to gather information over time
        
    * Gain trust to reduce defenses 
    * Can be combined with different techniques to gather information
    * Example: Calling customer service and acting like someone from corporate asking names of apps, or infrastructure, and/or buzz words. Then calling back and talking with said buzz words to pretend to be in the company to get more and more information. 
* Phishing
  * Obtaining sensitive information (usernames, passwords, credit card info)
  * Tricking a user into entering their info into a fake website
    * Email spoofing
    * Instant messaging
    * SMS (Smishing)
  * Pretend to be social media websites, auction sites, or communication from friends or colleagues
* Types of Phishing
  * Like phishing, expect the target is well researched and appears to come from a trusted sender
* Whaling 
  * Phish campaigns that target the "big fish" within an organizations, for things like wire transfers, tax information and other financial data
* Smishing
  * Phishing attacks carried over SMS
* Vishing
  * Social engineering techniques designed to get the victim to divulge personal or sensitive information
  * Attacker poses as a legitimate company, repair person, security personnel or someone of trust
    * Can come from internal or external to the company
* SPAM
  * Sending out large quantities of unsolicited emails
    *  Typically for commercial advertising
    *  Can also be used via social media, texts/IM, video and VoIP spam
  * SPAM over Instant Messaging (SPIM)
    * Can be more effective as the interactions can occur in real-time
* Dumpster Diving
  * An attacker can go into a companies dumpster to look for sensitive information
  * Username/passwords
  * Personally Identifiable Information (PII)
    * Mitigation - Shredding documents prior to disposal
* shoulder Surfing
  * Social engineering trick to get someone to enter credentials into an application or website
    * Strike up a conversation about their kid's sports, then ask to see some photos
    * Shoulder surf as they enter their username/password into social media website
      * Mitigation 
        * Privacy screens
        * Masked passwords
          * Multiple asterisks per keystroke further obfuscates the length of passwords
        * Technical Controls
          * Cameras to monitor doors, sensitive areas, key card access, etc
* Pharming
  * Redirecting a user's website traffic to a fake, malicious website
    * DNS cache poisoning 
    * Host file injection
      * The host file can be directed to an attacker machine
* Tailgating
  * Following someone into a building through a gated area or badged access area
  * People want to be helpful
  * Bad actors know that people will hold the door for people who look like they belong
    * Carrying lots of items, etc
  * Mitigation
    * Training and understanding of corporate police is key
* Hoaxes
  * Social engineering technique using the phone and/or voicemail to trick the target into providing sensitive information
    * Hacker acts like remote technician or employee
    * Interested party seeking employment
    * Angry customer filing complaint
  * Targeted phishing and spear phishing techniques aimed at "big fish" like company executives (i.e whaling)
    * Phishing, vishing and various social engineering techniques to gather information
    * Emails are targeted, very specific and seem legitimate
  * Mitigation
    * Security Awareness Training
      * Ensure employees know to never click links from sources they don't know
      * Don't open attachments from an unknown origin
    * Technical Controls
      * SPAM filtering 
      * Heuristics
      * Firewalls/Deep Packet Inspections
* Prepending
  * Adding mentions (@username) to tweets or social media posts to make them seem more personal
    * Higher engagement
    * Can be automated to become almost as efficient as manual spear-phishing campaigns
* Impersonation
  * Impersonation can be done via a number of methods:
  * Social engineering 
  * Stolen credentials/credential harvesting
  * Infiltrating a network and capturing and replaying packets on a network
* Identity Fraud
  * Malware, social engineering, and old-school methods (i.e. dumpster diving)
  * Victim's identity is used to obtain credit, steal money/assets, etc
* Invoice Scam
  * "Whaling" technique where bad actors spoof executive email accounts
  * Contact finance and/or accounts payable and ask them to pay a fraudulent invoice
    * Wire transfer
    * Company credit card
    * Crypto-currency
* Credential Harvesting
  * Phishing campaigns
    * Phishing, smishing, SPAM/SPIM, etc, can be used to gather user's credentials at scale
  * Malware
    * Can be used to target an individual victim, or entire websites and networks. Credentials are often harvested and sold or pasted online
  * Pastebin and other paste sites
    * Paste sites allow hackers and bad actors to post large amount of comprised accounts and information, as well as access other breach information
* Watering Hole Attack
  * Sophisticated attack that identifies less secure websites users in a particular company or organization are likely to visit
    * Attackers plant malware on the sites users visit to then infect the targeted users - once they visit the infected site
    * Malicious code scans the users' computer for vulnerabilities, zero-days, etc.
      * May download additional code to initiate attacks, siphon data, etc.
* Typo Squatting/URL Hijacking
  * Setting up domain names to capitalize on the fact that users make typos
    * Facbook.com instead of Facebook.com
    * Goggle, googel, googgle, etc\
  * Fraudulent websites are set up to resemble the real ones
    * Capture user credentials
  * Ad portals full of ads that might appeal to a user going to that website
    * Hoping to create as revenue by supplying complementary advertising
* Hybrid Warfare
  * Combination of traditional and irregular forces in the same military campaign
    * Guerillas, insurgents
    * Proxies, terrorists
    * Stat and non-state actors
  * Types of hybrid warfare
    * Information operations
    * Cyber activities 
    * Proxy Organizations
    * Economic Influence
    * Clandestine Measures
    * Political Influence
  * Social Media
    * Influence campaigns
      * Social media can be extremely powerful in shaping public opinion
        * Helping or hurting company image, stock price, consumer confidence
        * Public policy, elections, attitudes toward government, law enforcement, etc.
* Reasons for Effectiveness
  * Authority
    * Bad actor appears to know what they're talking about or had special knowledge of the company
    * Position of authority(executive or upper management)
      * Technical jargon
      * Name dropping 
      * Knowledge of specific systems/applications
  * Intimidation
    * Social engineer can use several techniques to then impose their will on the target
      * Threaten negative action
      * Threaten to release sensitive information
      * Can be combined with scarcity/urgency
  * Consensus/Social proof
    * People are more likely to act when they believe they are in alignment with the larger group
      * "Mob Mentality"
      * Bartender who seeds his tip jar
      * Review on shopping sites ("4 1/2 Stars" on Amazon, etc)
  * Familiarity/Liking
    * People like using or buying things they are already familiar with and like
    * Likely to converse with people they perceive to "be like them"
    * Attacker will establish a common contact or friend
      * Trust goes oup when people think they're dealing with someone with mutual friends or contacts
  * Trust
    * People are more likely to act when they trust the person situation
    * Social engineers can use a variety of tactics to shortcut the path to trust
      * Authority
      * Familiarity/company specific jargon
      * Name dropping
      * Shoulder surfing/dumpster diving
  * Scarcity/Urgency
    * Social engineering tactics to elicit action by making the target think they have to act quickly to take advantage of a special deal, pricing, etc
      * Victim feels they must act quickly or risk missing out
        * Dwindling stock
        * Time-based offer
        * Issue that need to be resolved quickly

### Analyzing Malware and Other Attacks
* Indicator of Compromise (IOC)
  * Artifacts observed that indicate (with a high degree of confidence) a computer intrusion
    * Some Potential Indicators of Compromise
      * Unusual outbound network traffic
      * DNS request anomalies
      * Mismatch port-application traffic
      * Anomalies in privileged user account activity
* Virus
  * Malicious code that requires user interaction to install and replicate
* Cryto-malware/Ransomware
  * Malicious application that scare or scam users into taking some type of action
    * Typically paying the creator for removal of the ransomware/decryption of files
* Trojan
  * Seemingly friendly software that contains hidden malicious software
* Worms
  * Self-replicating program that is usually self contained and can execute and spread without user interaction
  * Two main types of worms
    * Network Service Worms
      * Exploits network vulnerability to propagate and infect others
    * Mass Mailing Worms
      * Exploits email systems to spread and infect others
* Potentially Unwanted Program (PUP)
  * Applications that are typically downloaded as part of another program (adware, or spyware)d
* File-less Virus
  * Malware that operates in memory
    * Not stored in a file nor installed on a victim's machine
    * Typically hooks into a Windows PC via Powershell or WMI
    * 2017 Ponemon Institute study estimates that 77 percent of detected attacks were file-less
  * File-less/attack frameworks examples
    * Empire
    * PowerSploit
    * MetaSploit
    * CobaltStrike
  * Enables file-less malware creation and Powershell post-exploit framework
* Botnets
  * Malicious code that infects large numbers of hosts for the purpose of launching large scale attacks on specific targets
  * Attacker can be located anywhere in the world
  * Control one or more Command and Control (C&C) Servers
  * C&C servers can control thousands of bots (Zombies) for massive DDoS attacks
* Logic Bomb
  * Malicious code that triggers after a period of time based on some date or specific activity
* Spyware
  * Malicious software that captures user activity and reports back (keystrokes, website visits, etc.)
* Keylogger
  * Malicious application that once installed on a host can capture all keystrokes 
    * Usernames/Passwords
    * Sensitive Information
    * Emails/ chats/ instant messages
  * Captured files can be uploaded to a remote location, emailed, or stored locally for later retrieval
* Rootkits
  * Malicious code that installs itself at the OS or kernel level to avoid detection
  * Rootkits are very difficult to get rid of
    * Load before the OS loads
    * Can disable anti-virus and anti-malware
* Backdoors
  * Software that installs for the purpose of opening ports and installing additional software
  * Works in tandem with trojans
  * Can steal credentials, keylogger, etc
  * Applications, executables, and images can house backdoors
  * Can download additional software or allow remote access
* Spraying
  * Feeding a large number of usernames into a program that loops through passwords
  * Brute force type of attack that can be used with dictionary attacks or a database of compromised passwords
  * Mitigation - 2FA  
* Brute Force and Dictionary Attacks
  * Systematic approach trying every possible combination of passwords or passphrases
    * Time consuming 
    * Resource intensive
  * Mitigation's
    * Most account will lock out after "x" number of attempts
    * Length of password increases time to crack
  *  Dictionary
     *  Using known words to try and defeat a cipher
        *  Using words in a dictionary of a pre-defined set of possible words
        *  Faster than brute force in that only words that are likely to succeed are user
        * Common Tools
          * Brutus, Cain and Abel, Crack, Aircrack-ng, John the Ripper, Airodump-ng, L0phtCrack, Metaspolit Project, Ophcrack
  * Hybrid Attack combines dictionary attack along with word variations
    * Used prior to resorting to plain brute-force attack
* Rainbow Tables
  * Precomputed table to reversing cryptographic hashes
    * Reduces time to brute-force a password
    * Increases amount of storage necessary to storage rainbow tables 
    * Rainbow table needed for each has type(MD5, SHA1,etc)
  * Mitigated by using "Password Salting"
    * Adding random data to the hashing algorithm so that each users hash is unique even if both have the same password
      * Larger salts increase security
* Known Plain Text/ Ciphertext
  * Access to both the plain text and the encrypted output (ciphertext)
    * Tyhe attack can be used to reveal further information such as secret keys or code books used to encrypt subsequent messages
  * Mitigation - Advanced Encryption Standard (AES) cipher is not vulnerable to this type of attack
* Birthday Attack
  * Brute-force attack that works on the cryptographic phenomenon of hash collisions
    * Given enough time, two independent sources could yield the same hash
      * Rate of occurrence varies depending on hash algorithm
  * Birthday Paradox
    * In a room full of people, what is the probability that two will share the same birthday
      * 23 people = 50%
      * 30 people = 70%
      * 70 people = 99.9%
      * 253 people = 100%
  * Example:
    * If a users password is "p-1234ju" which equals the hash value of "2kj3g4i2g324" you can look for a password with the hash value of "2kj3g4i2g324" which the password could be "idontknowthepassword" and use that password to log in because the hash values equal
* Downgrade Attack
  * Attack that forces a system to negotiate down to a lower0quality method of communication
    * Allows an attacker to force a lower-grade, less secure method of communication
    * Typically allowed to enable communication with legacy systems
    * Often used with MiTM attacks
* Physical Attacks, Malicious USB, and Skimming
  * Malicious Universal
    * Gates, locks, doors
  * Universal Serial Bus (USB)
  * Malicious Flash Drive
  * Card Cloning
  * Skimming
    * Card reader used at checkout counter that scans magnetic strip
    * Duplicate card reader that slips over ATM card reader and downloads magnetic strip info
* Adversarial Artificial Intelligence
  * Tainted training data for ML
    * Technique to foll models by supplying deceptive (tainted) input
  * Security of ML algorithms
    * Threat modeling
    * Attack simulations
    * Countermeasures simulations
    * Secure learning algorithms
* Supply Chain Attack example
  * Attack on an organization by targeting less-secure elements in a supply network
    * Advanced Persistent Threats (Typically)
    * Targets victims further down the supply chain network
  * Example
    * POS malware / Infected USB sticks
    * MAlware (or hardware) installed on computer equipment or network gear before it reaches target company
* Cloud-based vs. On-prem Attacks
  * Effectiveness of security depends on many factors
    * Type of company / data center(s)
    * Industry (regulations, compliance)
  * Costs, expertise, data-mobility
  * Infrastructure refreshes
  * Frequency of data access
  * Cloud Provider Security
    * Large security staff
    * Deep expertise across a wide range of industries
    * 24/7 monitoring
    * Compliance and regulatory expertise

### Recognizing Application Attacks
* Privilege Escalation
  * Obtaining elevated privileges(i.e, Administrator or Root) on the target
    * Dump the SAM (Security Accounts Manager) (local accounts file)
    * Retrieve /etc/passwd file
    * Look for insecure files shares
    * DLL pre-loading
    * Insecure or weak security on processes 
  * Many vulnerabilities enable an attacker to gain system-level permissions
* Cross Site Scripting (XSS)
  * Techniques used to hijack sessions
    * Can be non-persistent (email, blog posts, etc)
    * Persistent (server based) where an attacker doesn't need to actively target a user
    * Non-Persistent
      * Specially crafted URL's sent in an e-mail, instant message, blog post, etc. 
    * DOM Based
      * Can be non-persistent and be used to hijack sessions, etc
    * Persistent
      * Server based and can execute on a victim's PC by visiting an infected site
  * Cross-Site Scripting via Email
    * User is sent an email containing a malicious link and is convinced to click on the link
    * The URL is sent to the legitimate site, along with malicious code which then executes in the victim's web browser
  * Cross-Site Scripting with Unauthorized Request
    * User is sent an email containing a malicious link and is convinced to click on the link
    * The URL is sent to the legitimate site, along with malicious code which then executes in the victim's web browser
    * The attacker could then issues additional requests to the legitimate server, post data to other parts of the site, etc.
* SQL Injection
  * SQL (Structured Query Language)
    * Modifying the SQL query that's passed to web application
    * SQL server, etc
  * Adding code into a data stream
    * bypass login screens
    * Vulnerable websites return usernames, passwords, wtc, with the right SQL injection
    * CAuse the application to "throw" an error and crash (allowing an attacker remote access)
* DLL Injection
  * DLL Injection is a process of inserting code into a running process
  * Four basic steps:
    * Attach to the process
    * Allocate Memory within the process memory and determine appropriate memory addresses
    * Instruct the process to Execute your DLL
  * DLL injection attacks can be created manually or pentesting tools like Metasploit can automate the process
* LDAP Injection
  * Light weight Directory Access Protocol
    * "Address Book" of user accounts used to authenticate users
    * Identifies level of access, group memberships, etc
  * Similar to SQL injection attacks in that the query that is passed to the web server is modified to include malicious query statements or code
* XML Injection
   ```
   # Form Input Example
   <input type="text" size=20 name="userName">Insert the username</input>

   # Underlying Code
   String ldapSearchQuery= "(cn=" + $userName + ")";
    System.out.println(ldapSearchQuery);

   # "crees) ( | (password = *) )"
   ```
  * Attack technique that manipulates the logic of an XML application or service
    * Could be used to inject XML into a statement that alters a path to a file to disclose sensitive information
    ```
    <?xml version"1.0"?>
    <!DOCTYPE results [<!ENTITY harmless SYSTEM
    "file:///var/www/config.ini">]>
    <results>
        <results>&harmless;</result>
    </results>
    ```
* Pointer Dereference
  * Vulnerability that can cause an application to throw an exception error, which typically results in the application crashing
    * Can be leveraged for a DoS attack against the entire system
    * Remote code execution
  * C/C++, Assembly or any other language that uses pointers is potentially vulnerable to this type of attack
* Directory Traversal / Command Injection
  * Attack that manipulates user input to cause the application to traverse a directory structure and access files not intended to 
* Buffer Overflow
  * Attack that causes a system or app to crash of behave unexpectedly
    * Writing more data than the buffer can handle
    * Data is written to adjacent memory
  * Calls or pointers to jump to a different address that what was intended
    * Can contain user executable code which could allow remote code execution
* Race Conditions
  * A race condition occurs when a pair of routine programming calls in an application do not perform in the sequential manner that was intended
    * Potential security vulnerability if the calls are not performed in the correct order
  * Potential Vulnerabilities
    * Authentication: Trust may be assigned to an entity who is not who it claims to be
    * Integrity: Data from an un-trusted (and possibly malicious) source may be integrated
    * Confidentiality: Data may be disclosed to an entity impersonating a trusted entity, resulting in information disclosure
* Time of Check
  * Type of race condition
    * Attacker is able to gain access prior to an authentication check
    * Inserts code or alters authentication to disrupt normal authentication processes 
    * Administrator see the intrusion, reset passwords, etc., but the attacker may still have access
      * Attacker could remain logged in with old credentials
  * Also referred to aas Time of Check to Time of Use (TOCTTOU)
* Secure Coding Concepts, Error Handling, and Input Validation
  * Application development is often a balancing act between time to market and security
    * Building for security adds to development time
      * Critical - If you don't have time to fine the vulnerabilities, the bad guys will
  * Error and exception handling
    * What does the application do when it encounters an error?
      * Does it continue running, restart a process or module, or completely crash?
    * If it crashes, does it give an attacker elevated privileges
      * Keys to the castle?
  * Input Validation
    * Validate/sanitize what is entered at the client side and/or server side before it's processed
    * Mitigate attacks such as Cross Site Scripting
    * SQL injections
  * References
    * OWASP 
    * CERT 
* Replay Attacks
  * Sniffing the wired or wireless network, a replay attack captures packets and puts them back on the wire
    * Packets can potentially be modified and retransmitted to look like legitimate packets
  * Mitigation - Sequencing helps mitigate the effectiveness of this type of attack
* Integer Overflow
  * Integer overflow condition occurs when the result of an arithmetic operation exceeds the maximum size of integer type used to store it
  * When the overflow occurs, the interpreted value appears to "wrap around" the max value and start at the min value
    * Could allow transactions to be reversed (i.e. money sent instead of received)
* Cross Site Request Forgery (XSRF)

    * CSRF or "See-Surf"
  * Requires victim to have recently visited the target website and have a valid cookie (not expired)
  * XSS & XSRF Distinction
    * In a XSS attack, the browser runs malicious code because it was served from a site it trusts
    * In a XSRF attack, the server performs an action because it was sent a request from a client it trusts
* API Attacks
  * Hostile usage of an API
    * Injection attacks
    * DoD/DDos Attacks
    * Authentication hijacking
    * Data exposure
    * MiTM attacks
  * Traditional methods of protection don't work
    * WAF and simple port blocking
    * Continuously evolving API's
  * Resource Exhaustion
    * Attack whereby a malicious user executes code or processes on a machine over and over until all resources are exhausted
    * Denial of Service (DoS) or Distributed Denial of Service (DDoS) are examples of this type of attack
* Memory Leak
  * A memory leak is typically an unintentional consumption of memory. The application fails to release the memory once it's no longer needed
  * This consumption of resources can over time lead to a variety of issues:
    * Degraded system performance
    * Abnormal system behavior
    * System crashes
    * DoS
  * Threat actors can use those vulnerabilities to try and crash a system to gain elevated privileges or take a system offline via a Denial of Service attack
* SSL Stripping
  * MitM type of attack that strips away SSL encryption
    * Enables an attacker to intercept traffic between victim and target
    * Enterprise users, wired or Wi-Fi hotspots, etc.
  * Mitigation
    * Use SSL everywhere
      * Not just on pages that contain sensitive data
    * Use HSTS
      * HTTP strict Transport Security
      * Forces clients/browsers to connect over HTTPS 
* Shimming
  * Shim databases are part of Microsoft Window's Application Compatibility Infrastructure
    * Used to maintain compatibility with legacy applications
    * Can be used for malicious purposes by custom shim databases to install code, patches, etc.
* Refactoring
  * Modifying an application's source code without changing the underlying functionality
    * Purpose - Fix bugs, patch code and tighten up security without changing or adversely affecting the underlying functionality
* Pass the Hash
  * Harvesting a user's password hash to authenticate to a remote server or service
  * Normal operation
    1. User wants to access remote resource
    2. Server sends authentication challenge
    3. User enters their credentials (username/password)
    4. Password in converted to a has value
    5. Hash value is sent to the server
    6. Server checks the hash  value against the expected value
    7. Access is granted to resource (assuming hash values match)
  * Passing the Hash
    1. Hacker wants to access remote resource
    2. Server sends authentication challenge
    3. Hacker enters username and stolen hash value
    4. Hash value is sent to the server
    5. Server checks the hash value against the expected value
    6. Access is granted to resource (assuming hash values match)

### Identifying Network Attacks
* Rogue Access Points and Evil Twin
  * Unauthorized access point
    * Used to steal or intercept data
    * Can be combined with jamming/interference techniques
  * Installed in a corporate network bu unauthorized personnel
  * Installed by hackers for Man in The Middle attacks
  * Evil Twin
    * Rogue access point that is impersonating a legitimate access point - using the same SSID
* Bluejack and Bluesnarfing
  * Sending of unauthorized messages or data to a victim's device via Bluetooth technology
  * Sending a vCard which contains a message in the name field to another Bluetooth-enabled device via the OB-EX (OBject-EXchange) protocol
  * Bluesnarfing
    * is the opposite of blue-jacking, in that data is pulled off the victims device
      * Contact lists
      * Pictures
      * Messages
    * All sorts of sensitive information can be stolen
      * Pictures Text Messages
      * Emails
      * Personally Identifiable Information (PII)
* Dissociation
  * An Attacker can create a DoD scenario on a wireless network by sending a spoofed disassociation frame
    * Source MAC address is set to that of the Access Point (AP)
* Jamming
  * Sending out excessive RF noise basically making Wi-Fi Channels unusable
  * Requires specialized equipment
  * illegal in most places
* RFID
  * Two types of RFID systems:
    * Active Reader/Passive Tag (ARPT)
    * Active Reader/Active Tag (ARAT)
  * Most commercial RFID for inventory control has an effective distance of ~3 ft.
* Near Field Communication (NFC)
  * Technology to allow communication between devices within close proximity to each other (usually 3-4")
    * Builds upon RFID (one-way) whereas NFC is two-way communication
    * Can be used by a malicious attacker to steal data from a nearby device
* IV Attack
  * Initialization Vector Attack
    * Weaker encryption had short IVs that would repeat fairly quickly
    * Attacker could flood the network, sniff the packets and see the IVs being sent
      * As they eventually repeat, the attacker could derive the IV and then gain access
  * WEP uses a 24-bit IV
    * Easily cracked
    * Since beed deprecated
* On-Path Attacks (Formerly MitB)
  * MAn in the Browser attack
    * The attacker send a malicious email or link and the Trojan gets installed on their machine
    * When a browser is launched - the code is then executed
    * Scans for known sites of attack
    * When banking sites are visited, the malware launches in the background
    * Executes commands/transactions, captures data, etc.
  * The user may see a loading screen thinking that the site is slow or something is wrong, meanwhile the scripts/commands are running, once finished the user gets sent to the actual site
* ARP Poisoning
  * Also known as ARP Cache Poisoning
    * Attacker sends out spoofed ARP (Address Resolution Protocol) messages onto a LAN to associate their machine with another host IP (i.e, default gateway) Layer 3 address down to the layer 1
    * Allows the attacker to intercept data intended for another recipient 
    * Can be used for DoS, MiTM, or session hijacking
* IP/MAC Spoofing
  * Masquerading as another using their IP or MAC address
    * IP address spoofing
    * Address Resolution Protocol (ARP) spoofing
      * ARP resolves an IP address to a MAC address
  * Can be used with MiTM attacks
* MAC Flooding (Media Access Control)
  * Network Switch will build a MAC table so that every computer connected to it will receive all its intended data
  * An attacker send a large number of ethernet frames while inside the network so that the server fills up the MAC table to the point that it forces out the MAC Address from the table so it sends all packets to all PC's can cause a DoS attack
  * This allows the attacker to see all the network traffic because the server doesn't know who to send packets to
* DNS Poisoning
  * Also known as "DNS Cache Poisoning"
    * Manipulating that data in a DNS server's cache to point to different IP address
    * Attack could redirect a site's traffic from the legitimate site to one they own
* Typo Squatting/URL Hijacking
  * Setting up domain names to capitalize on the fact that users make typos
    * Facbook.com instead of Facebook.com
    * Googgle, Googel, Googgle, etc.
  * Fraudulent websites are set up to resemble the real ones
    * Capture user credentials 
  * Ad portals full of ads that might appeal to a user going to that website
    * Hoping to create ad revenue by supplying complementary advertising
* Distributed Denial of Service (DDoS)
  * Large scale attack against a target
    * Botnets
    * Bot herders
    * Command and control center
  * C&C issues commands to botnet zombies to initiate attack against a target
        * Could be hundreds, thousands or millions of zombies comprising a botnet army
  * DoS
    * Similar type of attack but on a much smaller scale
* SMurf Attack (Amplification)
  * DDoS type of attack
    * Victim's IP address is spoofed and ICMP messages are broadcast to a computer network 
    * Recipients will respond with reply to victim's IP address, flooding it with responses
    * Goal being it will slow the target/victim PC to point of being unusable
  * Mitigation
    * Can be mitigated bu network administrators setting policy to disallow computers from responding to ICMP requests or broadcasts
    * Configure routers to not forward broadcasts (default on most routers)
* DDoS
  * DDoS type of attack
    * Goal being to slow down the target server or network to point of being unusable
  * Attack vectors
    * Network
      * DNS amplification (SMURF attack)
    * Application
      * HTTP GET/POST attacks
  * Operational Technology (OT)
    * Web Application Firewalls (WAF)
    * IP reputation databases
    * Challenge to requestor (i.e. CAPTCHA)
* Malicious Code Execution
  * Can be attack vectors
    * PowerShell
    * Python
    * Bash
    * Macros
    * Virtual Basic for Applications
  * Malware sent via email or malicious links
    * Malicious code can be installed and run to execute MiTM, MiTB and other data manipulation/exfiltration attacks
  * Infected USB sticks and other removable media
    * Scripts can be executed automatically upon access to install malicious code (malware, ransomware, backdoors)
  * Remote Access Trojans (RAT)/Backdoors
    * RAT programs can allow complete control over a target system including access to browser sessions, data, webcams, etc.
### Distinguishing Threat Actors, Vectors, and Intelligence Sources
* Script Kiddies
  * Hackers that are relatively new or unskilled
    * Typically looking to see that they can get into
    * The challenge is the attraction
    * Not typically associated with any organized hacking groups
    * Usually not well funded
* Hacktivists
  * Hackers who are motivated bu ideology or some social/political cause 
    * Can be well funded and skilled
    * Usually deface websites
    * Steal information
      * Personal information and credentials
    * DDoS
    * Not particularly patient or stealthy
* Organized Crime
  * Hackers who are motivated by financial gain
    * Deliberate with high technical capability
    * Well-funded
    * Patient and persistent
    * POS terminals, ATM machines, credit card numbers, etc.
    * Steal personal information for sale on the dark web
* Nation States/APT
  * Highly skilled hackers whose main goal is to penetrate government or commercial systems
    * Very well funded and connected
    * Government agency 
    * Cyber espionage
    * Data/IP theft
    * Sabotage
    * Cyber warfare
    * Very stealthy and persistent
* Insiders
  * Often motivated by financial gain
    * CERT advises that over 70% of IP theft cases involve insiders
    * Accidental exposure can occur from misuse or misconfigured systems
    * Data theft includes IP and company secrets
* Competitors
  * Motivated by financial gain
    * Competitive advantage
    * Theft of IP or company secrets
    * Sabotage
    * Can be well funded and range from low to high skilled
* Attack Vectors
  * Direct Access
    * Physical access
    * On-Site
    * Theft/removal
    * Physical security
    * User training & awareness
  * Wireless
    * Captive portal
    * Evil twin
    * Network sniffing 
    * VPN/Encryption
    * User training & awareness
  * Email
    * Malware
    * Malicious links
    * Phishing/Whaling
    * User training & awareness
  * Supply Chain
    * weak link 
    * Downstream attacks
    * SLA'a in place Assess links in the chain
  * Social Media
    * Malicious links 
    * Phishing
    * Social proof
    * Group consensus
    * User Training & awareness
  * Removable Media
    * USB sticks
    * CF cards
    * CD/DVD
    * MAlware/ransomware
    * Group policy
    * Corporate policies
    * Group policy Corporate policies
    * User training & awareness
  * Cloud
    * Cloud provider vulnerabilities
    * DDoS
    * Multi-tenancy
    * SLA's (Service Level Agreements) in place
    * Assess providers & 3rd party agreements
* Use of Open Source Intelligence
  | Tools for OSINT | | | | |
  | :-: | :-: | :-: | :-: | :-: |
  | Maltego | Metagoofil | Shodan | Google hacking Database | Spokeo |
  | FOCA | EXIF Data Viewers | BackTrack Linux | Buscador Linux |
  | Kali Linux | Social Engineer Toolkit | PeekYou | Lullar |
  | Wayback machine | YouGetSignal | Browser Plugins | Metasploit |

* Closed/Proprietary Intelligence
  * Commercial Sources
    * Typically not available to the public at large
    * Part of a software package and/or service
    * Often has SIEM integration SOAR capabilities built-in
* Vulnerability Databases
  * Google Hacking Database (GHDB)
    * www.exploit-db.com
  * VirusTotal
    * virustotal.com
  * NVD (National Vulnerability Database)
    * nvd.nist.gov
  * MITRE CVE database
    * cve.mitre.org
* Public and Private Information Sharing
  * Cybersecurity Act of 2015
    * Provided a framework for sharing of information between public and private sectors
    * Goal of sharing information across both sectors to help strengthen defense and quicken response times
  * Information Sharing and Analysis Centers(ISACs)
  * National cybersecurity and communications integration center (NCCIC)
* Indicators of Compromise(IOC)
  * Pieces of data (breadcrumbs) that can identify potential malicious activity
    * Common IOCs
      * Unusual outbound traffic
      * Unusual privileged account activity
      * Geographical anomalies
      * Suspicious registry or system file changes
      * Mismatched port-application traffic
* Automate Indicator Sharing (AIS)
  * Department of Homeland Security (DHS) free sharing service
    * Shares indicators between the federal government and private sector at machine speed
    * Participants connect to DHS managed systems at NCCIC
  * All systems must be able to communicate using STIX and TAXII specifications
  * STIX = Structured Threat Information Expression
  * TAXII = Trusted Automated Exchange of Indicator Information
* MITRE
  * MITRE is a not-for-profit organizations that manages federal funding for research projects across multiple agencies
    * Common Vulnerabilities and Exposures (CVE) database
    * Common Weakness Enumeration (CWE) database
  * MITRE ATT&CK (Adversarial Tactics, Techniques and Common Knowledge) Framework
    * Trusted Automated Exchange of Intelligence Information (TAXII)
      * Transport protocol that allows sharing of threat intelligence information over HTTPS using API's
    * Structured Threat information eXpression (STIX)
      * Standardized format for presenting threat intelligence information
  * Tactic Categories (314 Tactics)
    1. Initial access (11)
    2. Execution (33)
    3. Persistence (59)
    4. Privilege escalation (28)
    5. Defense evasion (67)
    6. Credential Access (19)
    7. Discovery (22)
    8. Lateral Movement (17)
    9. Collection (13)
    10. Command and Control (22)
    11. Exfiltration (9)
    12. Impact (14)
* Gathering and Correlating Information
  * Data in a vacuum, without context, is extremely difficult to interpret and understand exactly what data is valuable and what is noise
  * Categorize TTPs and Enrich Alerts to track, target and deter/prevent attacks
* Predictive Analysis
  * AI and machine learning
    * Provides proactive analysis to detect breaches before they occur
    * Learning algorithms constantly monitor learn and evolve to detect new and emerging threats
* Threat Maps
  * Provide real-time monitoring of threats
    * Type
    * Origin/destination
    * Threat level
  * Can be enriched with additional threat feeds/data
  * Localized for a specific company or industry, or global showing attacks worldwide
* File/Code Repositories
  * GitHub is the most common
    * Users/developers use GitHub as a repository for code version control
    * Numerous GitHub repositories are not secured properly, leaking sensitive information
  * Bitbucket has similar offerings, more geared toward enterprise customers
* Research Sources
  * Vender websites
  * Vulnerability feeds
  * Conferences
  * Academic journals
  * Request for comments (RFC)
  * Local industry groups
  * Social media
  * Threat feeds
    * Recorded Future
  * Adversary tactics, techniques, and procedures (TTP)
    * MITRE ATT&CK   
### Understanding Vulnerabilities and Security Risks
* Cloud-base vs. On-premise
  * Cloud-base
    * Cons:
      * Larger attack surface and multi-tenant infrastructure
      * Less direct control over security as it's managed by 3rd-party and/or contractors
    * Pros:
      * Large security team constantly monitoring
      * Typically larger investments in people, process and technology
  * On-premises
    * Cons:
      * Constant need to refresh and maintain infrastructure
      * Patching, upgrade firmware, monitor for security issues
    * Pros:
      * Direct control over security
      * Single-tenant infrastructure (usually) with dedicated security team
* New Threats/Zero Days
  * Government/Nation States
  * Organized Crime/Hacking Groups
  * Hacktivists/Script Kiddies
* Mis-configuration/Weak Configuration
  * Weak or improper configurations can expose an organization to risk 
    * False sense of security
    * Gaping holes in defenses
    * Increase the attack surface
  * Mitigated through vulnerability scanning and security audits
    * Establish a security/configuration baseline for each system and periodically audit
* Shared Accounts (Improperly Configured)
  * Users should not be able to share accounts/group accounts
    * Reduces auditing/logging
      * Very hard or impossible to tell what users made a change, accessed or deleted a file, etc.
  * Non-repudiation
    * Being able identify and validate user activity
* Weak Configuration Considerations
  * Open permissions
  * Unsecured root accounts
  * Errors (how they are handled)
  * Unsecured protocols
  * Default settings
  * Open ports and services
* Weak Cipher Suites and Implementations
  * Cryptographic algorithms used in a connection are bundled together to form cipher suite. Each suite contains:
    * Key exchange
    * Authentication
    * Encryption
    * Integrity algorithm
  * All four algorithms are not used all the time, depending on what is needed
  * The following encryption algorithms should not be used:
    * RC4
    * Triple-DES
    * 'NULL'
  * Industry best practices is to not use Triple-DES and use AES-128 or AES-256 instead
* Improper Certificate and Key Management
  * Many companies are at risk due to poor certificate and key managements practices
    * Manual certificate/key management
    * Lack of insight/reporting automation
    * No centralized policies
    * No method to replace compromised CA certificates
* Secure Protocols
  * When given the option, always choose the highest security possible when establishing communications over an unsecured medium
    * FTPS
    * HTTPS
    * SSL/TLS
    * Secure POP/IMAP
  * IP (Internet Protocol)
    * Connection-less protocol that's responsible for network addressing
    * Provides routing of packets between networks
  * TCP (Transmission Control Protocol)
    * Connection oriented protocol that established connections between end-points
    * Provides guaranteed delivery of packets
  * UDP (User Data-gram Protocol)
    * Connection-less oriented protocol with no guarantee of delivery (best effort)
  * TCP Three-Way Handshake
    * Three-way handshake establishes connection between two hosts
      * A client node sends a SYN data packet over an IP network to a server to determine if the server is open for a new connection
      * The target server must have open ports that can accept and initiate new connections. Server responds and returns a confirmation receipt (SYN/ACK packet)
* Default COnfigurations
  * Default configurations shouldn't be considered secure
    * Change things like admin accounts, default passwords
    * Harden systems wherever possible
    * Establish baselines and periodically audit for compliance
  * Establish a patching and lifecycle management cadence
* Third-party Risks
  * Vendor management
    * System integrations
    * Lack of vendor support
  * Supply chain
  * Outsourced code development
  * Data storage
* Vendor Management
  * Do their systems integrate with yours?
  * Are they acquiring new systems or deprecating existing ones?
  * Can/will they force you to upgrade or buy new?
  * Mergers/acquisitions
    * Do existing vendors support the newly acquired systems
  * Lack of vendor support
* Vulnerable Business Processes
  * False negatives are the opposite of false positive
    * You had an incident but failed to recognize it
      * Controls ser up improperly
      * Operator error
  * Type I, II, III Errors
    * Type I = False positives
    * Type II = False negatives
    * Type III = You arrive at the right conclusion for the wrong reasons 
* Outsourced Code Management
  * Agreements in place
    * Are there operating agreements stating who owns the code?
    * How are liability and potential damages addressed?
    * Where is data stored, how is it secured?
* Improper or Weak Patch Management
  * Firmware
  * Operating Systems
  * Applications
* Legacy Platforms
  * Security vulnerabilities
    * Older platforms often have bugs/vulnerabilities that don't have patches or updates
  * Hardware failures
    * As infrastructure ages, the rate of failures increase and the availability of parts decreases -introducing risk into the environment 
  * Tribal knowledge
    * Older platforms may have fewer people who are subject matter experts, making administrating and maintaining more of a challenge
* Impact Areas
  * Data loss
  * Data Breaches
  * Data exfiltration
  * Identity theft
  * Availability loss
* Effects of Impacts
  * Financial Impact
    * CCPA = California Consumer Privacy Act
    * GDPR = General Data Protection Regulation
  * Reputation Impact
### Defining Security Assessment Techniques
* Specific Types of Threats
  * Physical Damage
  * Natural Events
  * Loss of Essential services
  * Compromise of Information
  * Technical Failures
  * Compromise of Functions
* What is Cyber Threat Intelligence?
  * Gathering, Evaluation and Analyzing Data
    * Quickly gather information on what threats are being faced
  * Strategize Defense
    * Prevent the threat entirely or limit the damage caused
  * Understand all Details of a Threat
    * What tools are used, what was stolen, malware planted, methods of communication, etc.
* Importance of Cyber Threat Intelligence
  * Protect against disruption to the business
  * Continue to Do Business/ Make money
  * Retain Customer and Shareholder Confidence
  * Increase Profitability and/or Partner value
* Threat Intelligence Classification
  * Unknown-Unknown
    * We are unaware of the threat's existence. Basically flying blind with little chance to deter/remediate
  * Known-Unknown
    * Threats that are known, but we don't fully understand them (how they work, their intention, etc.)
  * Known-Known
    * Things (threats) we know about and we do fully understand. This understanding can be used to direct an outcome to deter or mitigate a threat
* Strategic, Operational, and Tactical Intelligence
  * Tactical Cyber Intelligence
    * Involves specific actions being taken to defend networks against malicious actors attempting infiltration. Relies upon sufficient resources being devoted to the strategic and operational levels.
  * Operational Cyber Intelligence
    * Bridges the strategic and tactical levels of operations. Assess the organizations operating environment to identify indicators and warnings of potential cyber risks.
  * Strategic Cyber Intelligence
    * Requires senior leadership to determine objectives and guidance, based on what is known of potential adversaries and what security posture is already in place, in order to successfully assess threats.
* Gathering and Correlating Information
  * Data in a vacuum, without context, is extremely difficult to interpret and understand exactly what data is valuable and what is noise
  * Categorize TTP's and Enrich Alerts to track, target and deter/prevent attacks
* Stages of Risk Management
  * Assessing Requirements
    * Understanding the business and IT objectives and how security can meet those objective
  * Aligning with Current Capabilities
    * Understand what's available today and what capabilities exist across people, process and technology
  * Creating Plans and Initiatives
    * Quantify existing gaps and develop plans to prioritize initiatives and fill the gaps
  * Creating Metrics and Monitoring Progress
    * Develop metrics to track progress and ensure programs are meeting business requirements
* Risk Management Data Sources
  * Internal Sources
    * Internal Audits
    * Known Issues
    * Previous Security Incidents
  * Threat Intelligence
    * Attack Frequency
    * Cost to Company
    * Emerging Bad Actors/Targets
  * Contextual Data
    * Industry
    * Technology
    * Geography
    * Attack Method
* Vulnerability Scanning
  * Vulnerability scanning is different from penetration testing 
    * Should be performed in tandem with pen testing
    * Non-intrusive and can be performed with credentials or without credentials depending on risk tolerance
  * Always obtain consent prior to beginning any type of vulnerability scan or pen test
    * Make sure that you're operating with proper permissions
    * Document the process and keep authorization forms readily available
* False Positive
  * No system is perfect and can occasionally generate false positives
    * Identify a vulnerability that doesn't actually exist
    * Results must be verified and audited for completeness and accuracy
* False Positive Audits
  * Controls should be routinely audited and reviewed
    * False positives are events that aren't really incidents
    * Anomalies that deviate from normal behavior
    * False positives can create excess work or minimize attention when real incidents occur
* False Negatives
  * False negatives are the opposite of false positives
    * You had an incident but failed to recognize it
      * Controls set up improperly
      * Operator error
  * Type I,II,III Errors
    * Type I - False positives
    * Type II - False negatives
    * Type III - You arrive at the right conclusion for the wrong reasons
* Intrusive vs, Non-intrusive
  * Intrusive testing can disrupt normal operations or have a greater impact of reducing system responsiveness
  * Non-intrusive simply identifies vulnerabilities and reports finding for later review and possible remediation
* Passively Test Security Controls
  * Vulnerability scanning is by nature a passive test
    * No disruption to the business
    * Observes and reports on finding
    * Does not take down systems, applications or services
* Credentialed vs. Non-credentialed
  * Scans and tests can be run with network/system credentials or without
    * Credentialed access has easier access and less impact on tested systems as well as more accurate results
    * Non-credentialed access requires more resources as a system may try to brute-force access or try multiple things to gain access
  * Attackers typically start out with non-credentialed access
    * They normally don't know much about the networks they're attacking
  * Attackers try to gain privileged account access
    * Gain administrator or root access
    * Providing much more detail about the network and associated systems
* Identify Vulnerabilities and Lack of Security Controls
  * Scanners will report on the various vulnerabilities found
    * Missing patches
    * Security misconfigurations
    * Known exploits
  * Often times it's more than just the security control is misconfigured or missing a patch
    * The security control itself might be missing 
      * Anti-virus programs
      * Missing patches
    * Interview personnel
* Identify Common Misconfigurations
  * Nessus, Metasploit and other similar programs can identify security misconfigurations
  * Review logs and perform audits of key assets
      * Open ports
      * Weak passwords
      * Active default accounts and passwords
      * Sensitive data leakage
      * Audit against security baseline to identify unauthorized changes
* Things to Remember
  * Obtain Consent
    * Very important to have consent in writing
    * Vulnerability scanning or pentesting without consent can be considered an attack and grounds for dismissal
  * Review company guidelines and "rules of engagement"
  * Identify and assess tester's skills and background
    * Verify and obtain references when possible
    * Tester could potentially have access to sensitive corporate data
* Common Vulnerabilities and Exposures (CVE)
  * Reference for publicly known information security vulnerabilities
  * Maintained by the Mitre Corporation
    * CVE-YYYY-NNNN
* Common Vulnerability Scoring System (CVSS)
  * Open framework for communicating the characteristics and severity of software vulnerabilities
  * CVSS is maintained by Forum of Incident Response and Security Teams (FIRST) and is used to assess the principal characteristics of a vulnerability and produce a numerical score reflecting its severity (scale of 1-10)
  * The Numerical score can then be translated into low, medium, high to help organizations properly assess vulnerabilities and prioritize resources to manage and mitigate.
  * Scores
    * Base Scores
    * Temporal
    * Environmental
    * Overall
* Security Information and Event Management (SEIM)
  * SIEM are software suites that provide the following:
    * Collects data
    * Aggregates that data
    * Analyzes normalized data for anomalies, threats and trends
    * Investigates alerts, identifies breaches and takes action
    * Remediates discovered vulnerabilities
    * Reports on risk and compliance
* Security Orchestration, Automation, and Response (SOAR)
  * Complements SIEM
  * Aggregates all tools wintin a SOC and provides automated playbooks
    * Ticket creation, case management, etc. 
    * Integrations with 3rd party products

### Defining Penetration Testing
* Penetration Testing
  * Also called pen testing, is the practice of testing a computer system, network or web application to find vulnerabilities that an attacker could exploit
* Penetration Testing Steps
  * Establish Goal/Set parameters
  * Reconnaissance/Discovery
  * Exploitation/Brute Force
  * Take control/ Escalate Privilege
  * Pivoting
  * Data Collection/Reporting
* Known, Unknown, and Partially Know Environments
  * Unknown environment
    * Tester is given little to no information about the target. More like real world, but more time consuming and more expensive
  * Known environment
    * Tester is given full disclosure about the target(i.e. network, hosts, source code, protocols, diagrams, etc.)
  * Partially known 
    * Combination of known and unknown, in that tester is given partial information about the target, but not access to documentation or data
* Rule of Engagement
  * RoE should clearly define what is in-scope for the engagement
    * What activities are allowed
      * What activities are prohibited
      * Key stakeholders
      * Relevant contact lists
      * Communication methods/frequency
      * Handling of sensitive data
      * Specific goals/ definition of success
  * CREST Framework
    * Internationally recognized accreditation
      * Various areas of information security and assurance
    * Provides vetted resources for companies looking for providers
      * Adherence to industry benchmarks and best practices
    * Government and regulatory standardization
      * Access to qualified talent, supply chain and logistics assurance
      * https://crest-approved.org
* Lateral Movement
  * Attacker -> Internet -> Victim -> Network
* Escalation of Privilege
  * Primary goal when accessing a host
    * Administrator or Root access to the host 
      * Enables installation or persistence mechanisms
      * Scan for additional exploits, vulnerabilities and misconfigurations
* Methods of Privilege Escalation
  * Hack the local admin account
  * Exploit a vulnerability
  * Use tools/brute force
  * Social engineering
* Persistence
  * Installing backdoors or methods to maintain access to a host or network
* Cleanup
  * Removing traces of the attack
    * Removing files
    * Cleaning/deleting log files
    * Intentionally leaving false artifacts
    * Encrypting or deleting data
  * Firewalls, routers, servers
* Bug Bounty
  * Program to encourage users to find and report bugs
    * Awards range from recognition to compensation
  * First known bug bounty was implemented in 1983
  * Netscape engineer coined the phrase in 1995
  * Bug bounty programs
    * Hackerone.com offers bug bounty programs with a network of over 750k ethical hackers
* Pivoting 
  * Pivoting is a technique that allows lateral movement from a compromised host
    * Foothold is gained on a target system
    * Compromised target system is leveraged to compromise other, normally inaccessible systems
  * Many tools (Metasploit) have built in utilities to automate much of the process
* Types of Reconnaissance
  * Passive Reconnaissance
    * Utilize publicly accessible methods to discover information about the target
    * No direct contact with the target company
    * Public records
    * Google searches/GHDB
    * Company website/Wayback Machine
  * Active Reconnaissance
    * Direct access to the target company
    * Asking questions of employees, management, etc.
    * Entering the facilities and walking the site
    * Seeing where you can go, what things you can access
    * Active scanning,fingerprinting the network, hosts, etc.
* War Flying
  * Using an airplane, drones or UAV to sniff Wi-Fi networks
    * Calculate GPS coordinates
    * Aerial imagery
  * Typical flight times can last up to 30-45 minutes
  * Drones have been shown to pick up networks even at elevations of 1,500 to 2,000 feet
* War Driving
  * Actively seeking out wireless access points with little to no security
    * Open, WEP, WPA
* Red, Blue, Purple, and White Security Teams
  * Red team
    * Offensive Security 
    * Ethical Hackers
    * Pen Testers
  * Blue team
    * Defensive security
    * Infrastructure Protection
    * DFIR
  * Purple Team
    * Facilitate collaboration
    * Improve skills of both teams
  * White team
    * Define the rules of Engagement (RoE)
    * Manage engagement