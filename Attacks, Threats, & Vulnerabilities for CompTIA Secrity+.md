# Attacks, Threats, & Vulnerabilities for CompTIA Security+

### Comparing Different types of social engineering techniques
* A social engineer is someone who is a master of asking seemingly non-invasive questions to gather information over time
        
    * Gain trust to reduce defenses 
    * Can be combined with different techniques to gather information
    * Example: Calling customer service and acting like someone from corporate asking names of apps, or infrastructure, and/or buzz words. Then calling back and talking with said buzz words to pretend to be in the company to get more and more information. 
* Phishing
  * Obtaining sensitive information (usernames, passwords, credit card info)
  * Tricking a user into entering their info into a fake website
    * Email spoofing
    * Instant messaging
    * SMS (Smishing)
  * Pretend to be social media websites, auction sites, or communication from friends or colleagues
* Types of Phishing
  * Like phishing, expect the target is well researched and appears to come from a trusted sender
* Whaling 
  * Phish campaigns that target the "big fish" within an organizations, for things like wire transfers, tax information and other financial data
* Smishing
  * Phishing attacks carried over SMS
* Vishing
  * Social engineering techniques designed to get the victim to divulge personal or sensitive information
  * Attacker poses as a legitimate company, repair person, security personnel or someone of trust
    * Can come from internal or external to the company
* SPAM
  * Sending out large quantities of unsolicited emails
    *  Typically for commercial advertising
    *  Can also be used via social media, texts/IM, video and VoIP spam
  * SPAM over Instant Messaging (SPIM)
    * Can be more effective as the interactions can occur in real-time
* Dumpster Diving
  * An attacker can go into a companies dumpster to look for sensitive information
  * Username/passwords
  * Personally Identifiable Information (PII)
    * Mitigation - Shredding documents prior to disposal
* shoulder Surfing
  * Social engineering trick to get someone to enter credentials into an application or website
    * Strike up a conversation about their kid's sports, then ask to see some photos
    * Shoulder surf as they enter their username/password into social media website
      * Mitigation 
        * Privacy screens
        * Masked passwords
          * Multiple asterisks per keystroke further obfuscates the length of passwords
        * Technical Controls
          * Cameras to monitor doors, sensitive areas, key card access, etc
* Pharming
  * Redirecting a user's website traffic to a fake, malicious website
    * DNS cache poisoning 
    * Host file injection
      * The host file can be directed to an attacker machine
* Tailgating
  * Following someone into a building through a gated area or badged access area
  * People want to be helpful
  * Bad actors know that people will hold the door for people who look like they belong
    * Carrying lots of items, etc
  * Mitigation
    * Training and understanding of corporate police is key
* Hoaxes
  * Social engineering technique using the phone and/or voicemail to trick the target into providing sensitive information
    * Hacker acts like remote technician or employee
    * Interested party seeking employment
    * Angry customer filing complaint
  * Targeted phishing and spear phishing techniques aimed at "big fish" like company executives (i.e whaling)
    * Phishing, vishing and various social engineering techniques to gather information
    * Emails are targeted, very specific and seem legitimate
  * Mitigation
    * Security Awareness Training
      * Ensure employees know to never click links from sources they don't know
      * Don't open attachments from an unknown origin
    * Technical Controls
      * SPAM filtering 
      * Heuristics
      * Firewalls/Deep Packet Inspections
* Prepending
  * Adding mentions (@username) to tweets or social media posts to make them seem more personal
    * Higher engagement
    * Can be automated to become almost as efficient as manual spear-phishing campaigns
* Impersonation
  * Impersonation can be done via a number of methods:
  * Social engineering 
  * Stolen credentials/credential harvesting
  * Infiltrating a network and capturing and replaying packets on a network
* Identity Fraud
  * Malware, social engineering, and old-school methods (i.e. dumpster diving)
  * Victim's identity is used to obtain credit, steal money/assets, etc
* Invoice Scam
  * "Whaling" technique where bad actors spoof executive email accounts
  * Contact finance and/or accounts payable and ask them to pay a fraudulent invoice
    * Wire transfer
    * Company credit card
    * Crypto-currency
* Credential Harvesting
  * Phishing campaigns
    * Phishing, smishing, SPAM/SPIM, etc, can be used to gather user's credentials at scale
  * Malware
    * Can be used to target an individual victim, or entire websites and networks. Credentials are often harvested and sold or pasted online
  * Pastebin and other paste sites
    * Paste sites allow hackers and bad actors to post large amount of comprised accounts and information, as well as access other breach information
* Watering Hole Attack
  * Sophisticated attack that identifies less secure websites users in a particular company or organization are likely to visit
    * Attackers plant malware on the sites users visit to then infect the targeted users - once they visit the infected site
    * Malicious code scans the users' computer for vulnerabilities, zero-days, etc.
      * May download additional code to initiate attacks, siphon data, etc.
* Typo Squatting/URL Hijacking
  * Setting up domain names to capitalize on the fact that users make typos
    * Facbook.com instead of Facebook.com
    * Goggle, googel, googgle, etc\
  * Fraudulent websites are set up to resemble the real ones
    * Capture user credentials
  * Ad portals full of ads that might appeal to a user going to that website
    * Hoping to create as revenue by supplying complementary advertising
* Hybrid Warfare
  * Combination of traditional and irregular forces in the same military campaign
    * Guerillas, insurgents
    * Proxies, terrorists
    * Stat and non-state actors
  * Types of hybrid warfare
    * Information operations
    * Cyber activities 
    * Proxy Organizations
    * Economic Influence
    * Clandestine Measures
    * Political Influence
  * Social Media
    * Influence campaigns
      * Social media can be extremely powerful in shaping public opinion
        * Helping or hurting company image, stock price, consumer confidence
        * Public policy, elections, attitudes toward government, law enforcement, etc.
* Reasons for Effectiveness
  * Authority
    * Bad actor appears to know what they're talking about or had special knowledge of the company
    * Position of authority(executive or upper management)
      * Technical jargon
      * Name dropping 
      * Knowledge of specific systems/applications
  * Intimidation
    * Social engineer can use several techniques to then impose their will on the target
      * Threaten negative action
      * Threaten to release sensitive information
      * Can be combined with scarcity/urgency
  * Consensus/Social proof
    * People are more likely to act when they believe they are in alignment with the larger group
      * "Mob Mentality"
      * Bartender who seeds his tip jar
      * Review on shopping sites ("4 1/2 Stars" on Amazon, etc)
  * Familiarity/Liking
    * People like using or buying things they are already familiar with and like
    * Likely to converse with people they perceive to "be like them"
    * Attacker will establish a common contact or friend
      * Trust goes oup when people think they're dealing with someone with mutual friends or contacts
  * Trust
    * People are more likely to act when they trust the person situation
    * Social engineers can use a variety of tactics to shortcut the path to trust
      * Authority
      * Familiarity/company specific jargon
      * Name dropping
      * Shoulder surfing/dumpster diving
  * Scarcity/Urgency
    * Social engineering tactics to elicit action by making the target think they have to act quickly to take advantage of a special deal, pricing, etc
      * Victim feels they must act quickly or risk missing out
        * Dwindling stock
        * Time-based offer
        * Issue that need to be resolved quickly

### Analyzing Malware and Other Attacks
* Indicator of Compromise (IOC)
  * Artifacts observed that indicate (with a high degree of confidence) a computer intrusion
    * Some Potential Indicators of Compromise
      * Unusual outbound network traffic
      * DNS request anomalies
      * Mismatch port-application traffic
      * Anomalies in privileged user account activity
* Virus
  * Malicious code that requires user interaction to install and replicate
* Cryto-malware/Ransomware
  * Malicious application that scare or scam users into taking some type of action
    * Typically paying the creator for removal of the ransomware/decryption of files
* Trojan
  * Seemingly friendly software that contains hidden malicious software
* Worms
  * Self-replicating program that is usually self contained and can execute and spread without user interaction
  * Two main types of worms
    * Network Service Worms
      * Exploits network vulnerability to propagate and infect others
    * Mass Mailing Worms
      * Exploits email systems to spread and infect others
* Potentially Unwanted Program (PUP)
  * Applications that are typically downloaded as part of another program (adware, or spyware)d
* File-less Virus
  * Malware that operates in memory
    * Not stored in a file nor installed on a victim's machine
    * Typically hooks into a Windows PC via Powershell or WMI
    * 2017 Ponemon Institute study estimates that 77 percent of detected attacks were file-less
  * File-less/attack frameworks examples
    * Empire
    * PowerSploit
    * MetaSploit
    * CobaltStrike
  * Enables file-less malware creation and Powershell post-exploit framework
* Botnets
  * Malicious code that infects large numbers of hosts for the purpose of launching large scale attacks on specific targets
  * Attacker can be located anywhere in the world
  * Control one or more Command and Control (C&C) Servers
  * C&C servers can control thousands of bots (Zombies) for massive DDoS attacks
* Logic Bomb
  * Malicious code that triggers after a period of time based on some date or specific activity
* Spyware
  * Malicious software that captures user activity and reports back (keystrokes, website visits, etc.)
* Keylogger
  * Malicious application that once installed on a host can capture all keystrokes 
    * Usernames/Passwords
    * Sensitive Information
    * Emails/ chats/ instant messages
  * Captured files can be uploaded to a remote location, emailed, or stored locally for later retrieval
* Rootkits
  * Malicious code that installs itself at the OS or kernel level to avoid detection
  * Rootkits are very difficult to get rid of
    * Load before the OS loads
    * Can disable anti-virus and anti-malware
* Backdoors
  * Software that installs for the purpose of opening ports and installing additional software
  * Works in tandem with trojans
  * Can steal credentials, keylogger, etc
  * Applications, executables, and images can house backdoors
  * Can download additional software or allow remote access
* Spraying
  * Feeding a large number of usernames into a program that loops through passwords
  * Brute force type of attack that can be used with dictionary attacks or a database of compromised passwords
  * Mitigation - 2FA  
* Brute Force and Dictionary Attacks
  * Systematic approach trying every possible combination of passwords or passphrases
    * Time consuming 
    * Resource intensive
  * Mitigation's
    * Most account will lock out after "x" number of attempts
    * Length of password increases time to crack
  *  Dictionary
     *  Using known words to try and defeat a cipher
        *  Using words in a dictionary of a pre-defined set of possible words
        *  Faster than brute force in that only words that are likely to succeed are user
        * Common Tools
          * Brutus, Cain and Abel, Crack, Aircrack-ng, John the Ripper, Airodump-ng, L0phtCrack, Metaspolit Project, Ophcrack
  * Hybrid Attack combines dictionary attack along with word variations
    * Used prior to resorting to plain brute-force attack
* Rainbow Tables
  * Precomputed table to reversing cryptographic hashes
    * Reduces time to brute-force a password
    * Increases amount of storage necessary to storage rainbow tables 
    * Rainbow table needed for each has type(MD5, SHA1,etc)
  * Mitigated by using "Password Salting"
    * Adding random data to the hashing algorithm so that each users hash is unique even if both have the same password
      * Larger salts increase security
* Known Plain Text/ Ciphertext
  * Access to both the plain text and the encrypted output (ciphertext)
    * Tyhe attack can be used to reveal further information such as secret keys or code books used to encrypt subsequent messages
  * Mitigation - Advanced Encryption Standard (AES) cipher is not vulnerable to this type of attack
* Birthday Attack
  * Brute-force attack that works on the cryptographic phenomenon of hash collisions
    * Given enough time, two independent sources could yield the same hash
      * Rate of occurrence varies depending on hash algorithm
  * Birthday Paradox
    * In a room full of people, what is the probability that two will share the same birthday
      * 23 people = 50%
      * 30 people = 70%
      * 70 people = 99.9%
      * 253 people = 100%
  * Example:
    * If a users password is "p-1234ju" which equals the hash value of "2kj3g4i2g324" you can look for a password with the hash value of "2kj3g4i2g324" which the password could be "idontknowthepassword" and use that password to log in because the hash values equal
* Downgrade Attack
  * Attack that forces a system to negotiate down to a lower0quality method of communication
    * Allows an attacker to force a lower-grade, less secure method of communication
    * Typically allowed to enable communication with legacy systems
    * Often used with MiTM attacks
* Physical Attacks, Malicious USB, and Skimming
  * Malicious Universal
    * Gates, locks, doors
  * Universal Serial Bus (USB)
  * Malicious Flash Drive
  * Card Cloning
  * Skimming
    * Card reader used at checkout counter that scans magnetic strip
    * Duplicate card reader that slips over ATM card reader and downloads magnetic strip info
* Adversarial Artificial Intelligence
  * Tainted training data for ML
    * Technique to foll models by supplying deceptive (tainted) input
  * Security of ML algorithms
    * Threat modeling
    * Attack simulations
    * Countermeasures simulations
    * Secure learning algorithms
* Supply Chain Attack example
  * Attack on an organization by targeting less-secure elements in a supply network
    * Advanced Persistent Threats (Typically)
    * Targets victims further down the supply chain network
  * Example
    * POS malware / Infected USB sticks
    * MAlware (or hardware) installed on computer equipment or network gear before it reaches target company
* Cloud-based vs. On-prem Attacks
  * Effectiveness of security depends on many factors
    * Type of company / data center(s)
    * Industry (regulations, compliance)
  * Costs, expertise, data-mobility
  * Infrastructure refreshes
  * Frequency of data access
  * Cloud Provider Security
    * Large security staff
    * Deep expertise across a wide range of industries
    * 24/7 monitoring
    * Compliance and regulatory expertise

### Recognizing Application Attacks
* Privilege Escalation
  * Obtaining elevated privileges(i.e, Administrator or Root) on the target
    * Dump the SAM (Security Accounts Manager) (local accounts file)
    * Retrieve /etc/passwd file
    * Look for insecure files shares
    * DLL pre-loading
    * Insecure or weak security on processes 
  * Many vulnerabilities enable an attacker to gain system-level permissions

* Cross Site Scripting (XSS)
  * Techniques used to hijack sessions
    * Can be non-persistent (email, blog posts, etc)
    * Persistent (server based) where an attacker doesn't need to actively target a user
    * Non-Persistent
      * Specially crafted URL's sent in an e-mail, instant message, blog post, etc. 
    * DOM Based
      * Can be non-persistent and be used to hijack sessions, etc
    * Persistent
      * Server based and can execute on a victim's PC by visiting an infected site
  * Cross-Site Scripting via Email
    * User is sent an email containing a malicious link and is convinced to click on the link
    * The URL is sent to the legitimate site, along with malicious code which then executes in the victim's web browser
  * Cross-Site Scripting with Unauthorized Request
    * User is sent an email containing a malicious link and is convinced to click on the link
    * The URL is sent to the legitimate site, along with malicious code which then executes in the victim's web browser
    * The attacker could then issues additional requests to the legitimate server, post data to other parts of the site, etc.
* SQL Injection
  * SQL (Structured Query Language)
    * Modifying the SQL query that's passed to web application
    * SQL server, etc
  * Adding code into a data stream
    * bypass login screens
    * Vulnerable websites return usernames, passwords, wtc, with the right SQL injection
    * CAuse the application to "throw" an error and crash (allowing an attacker remote access)
* DLL Injection
  * DLL Injection is a process of inserting code into a running process
  * Four basic steps:
    * Attach to the process
    * Allocate Memory within the process memory and determine appropriate memory addresses
    * Instruct the process to Execute your DLL
  * DLL injection attacks can be created manually or pentesting tools like Metasploit can automate the process
* LDAP Injection
  * Light weight Directory Access Protocol
    * "Address Book" of user accounts used to authenticate users
    * Identifies level of access, group memberships, etc
  * Similar to SQL injection attacks in that the query that is passed to the web server is modified to include malicious query statements or code
* XML Injection
   ```
   # Form Input Example
   <input type="text" size=20 name="userName">Insert the username</input>

   # Underlying Code
   String ldapSearchQuery= "(cn=" + $userName + ")";
    System.out.println(ldapSearchQuery);

   # "crees) ( | (password = *) )"
   ```
  * Attack technique that manipulates the logic of an XML application or service
    * Could be used to inject XML into a statement that alters a path to a file to disclose sensitive information
    ```
    <?xml version"1.0"?>
    <!DOCTYPE results [<!ENTITY harmless SYSTEM
    "file:///var/www/config.imi">]>
    <results>
        <results>&harmless;</result>
    </results>
    ```
* Pointer Dereference
  * Vulnerability that can cause an application to throw an exception error, which typically results in the application crashing
    * Can be leveraged for a DoS attack against the entire system
    * Remote code execution
  * C/C++, Assembly or any other language that uses pointers is potentially vulnerable to this type of attack
* Directory Traversal / Command Injection
  * 
* Buffer Overflow
* Race Conditions
* Time of Check
* Secure Coding Concepts, Error Handling, and Input Validation
* Replay Attacks
* Integer Overflow
* Cross Site Request Forgery (XSRF)
* API Attacks
* Resource Exhaustion
* Memory Leak
* SSL Stripping
* Shimming
* Refactoring
* Pass the Hash

### Identifying Network Attacks
* Rogue Access Points and Evil Twin
* Bluejack and Bluesnarfing
* Dissociation
* Jamming
* RFID
* Near Field Communication (NFC)
* IV Attack
* On-Path Attacks (Formerly MiTM)
* On-Path Attacks (Formerly MiTB)
* ARP Poisoning
* IP/MAC Spoofing
* MAC Flooding
* MAC Cloning
* DNS Poisoning
* Typo Squatting/URL Hijacking
* Distributed Denial of Service (DDoS)
* Malicious Code Execution

### Distinguishing Threat Actors, Vectors, and Intelligence Sources
* Script Kiddies
* Hacktivists
* Organized Crime
* Nation States/APT
* Insiders
* Competitors
* Threat Actor Attributes
* Attack Vectors
* Use of Open Source Intelligence
* CLosed/Proprietary Intelligence
* Vulnerability Databases
* Public and Private Information Sharing
* Dark Web
* Indicators of Compromise(IOC)
* Automate Indicator Sharing (AIS)
* TAXII Layout
* MITRE
* Gathering and Correlating Information
* Predictive Analysis
* Threat Maps
* Live Cyber Threat Map
* File/Code Repositories
* Research Sources

### Understanding Vulnerabilities and Security Risks
* Cloud-base vs. On-premise
* New Threats/Zero Days
* Mis-configuration/Weak Configuration
* Shared Accounts (Improperly Configured)
* Weak Configuration Considerations
* Weak Cipher Suites and Implementations
* Improper Certificate and Key Management
* Secure Protocols
* Default COnfigurations
* Third-party Risks
* Vendor Management
* Vulnerable Business Processes
* Outsourced Code Management
* Improper or Weak Patch Management
* Legacy Platforms
* Impact Areas
* Effects of Impacts

### Defining Security Assessment Techniques
* Specific Types of Threats
* What is Cyber Threat Intelligence?
* Importance of Cyber Threat Intelligence
* Threat Intelligence Classification
* Strategic, Operational, and Tactical Intelligence
* Gathering and Correlating Information
* Stages of Risk Management
* Risk Management Data Sources
* Vulnerability Scanning
* False Positive 
* False Positive Audits
* False Negatives
* Intrusive vs, Non-intrusive
* Passively Test Security Controls
* Credentialed vs. Non-credentialed
* Identify Vulnerabilities and Lack of Security Controls
* Identify Common Misconfigurations
* Things to Remember
* Common Vulnerabilities and Exposures (CVE)
* CVSS
* Security Information and Event Management (SEIM)
* Security Orchestration, Automation, and Response

### Defining Penetration Testing
* Penetration Testing
* Penetration Testing Steps
* Known, Unknown, and Partially Know Environments
* Rule of Engagement
* Lateral Movement
* Escalation of Privilege
* Methods of Privilege Escalation
* Persistence
* Cleanup
* Bug Bounty
* Pivoting 
* Types of Reconnaissance
* War Flying
* War Driving
* Red, Blue, Purple, and White Security Teams

